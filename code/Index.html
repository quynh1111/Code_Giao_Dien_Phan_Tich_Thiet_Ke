<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trang chủ học viên - EduLearn</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      background-color: #f8f9fa;
      color: #212529;
    }
    header {
      background-color: #1c1d1f;
      color: white;
      padding: 1.5rem;
      text-align: center;
    }
    nav {
      background-color: #2d2f31;
      display: flex;
      justify-content: flex-start;
      gap: 2rem;
      padding: 1rem 2rem;
    }
    nav a {
      color: white;
      font-weight: 500;
      text-decoration: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      transition: background-color 0.2s;
    }
    nav a:hover {
      background-color: #3e4143;
    }
    main {
      padding: 2rem;
      max-width: 1200px;
      margin: auto;
    }
    section {
      background-color: white;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    h2 {
      color: #1c1d1f;
      margin-bottom: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      text-align: left;
      padding: 1rem;
      border-bottom: 1px solid #dee2e6;
    }
    th {
      background-color: #f1f3f5;
      font-weight: 600;
    }
    button {
      padding: 0.5rem 1rem;
      background-color: #a435f0;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #892cdc;
    }
    input, select {
      padding: 0.75rem;
      width: 100%;
      margin-top: 0.5rem;
      margin-bottom: 1rem;
      border: 1px solid #ced4da;
      border-radius: 4px;
      font-size: 1rem;
    }
    footer {
      background-color: #1c1d1f;
      color: white;
      text-align: center;
      padding: 1rem;
      margin-top: 3rem;
    }
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 8px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <h1>Chào mừng bạn đến với EduLearn</h1>
  </header>

  <nav>
    <a href="#">Trang chủ</a>
    <a href="#khoahoc">Khóa học</a>
    <a href="#hoso">Hồ sơ</a>
    <a href="#doimatkhau">Đổi mật khẩu</a>
    <a href="#lichsu">Lịch sử</a>
  </nav>

  <main>
    <!-- Danh sách khóa học -->
    <section id="khoahoc">
      <h2>Danh sách khóa học</h2>
      <table>
        <thead>
          <tr>
            <th>Tên khóa học</th>
            <th>Mô tả</th>
            <th>Giá</th>
            <th>Đăng ký</th>
          </tr>
        </thead>
        <tbody id="course-list"></tbody>
      </table>
    </section>

    <!-- Hồ sơ cá nhân -->
    <section id="hoso">
      <h2>Hồ sơ cá nhân</h2>
      <input type="text" value="Nguyễn Văn A">
      <input type="email" value="nva@email.com">
      <input type="text" value="Học viên">
      <button>Lưu hồ sơ</button>
    </section>

    <!-- Đổi mật khẩu -->
    <section id="doimatkhau">
      <h2>Đổi mật khẩu</h2>
      <input type="password" placeholder="Mật khẩu hiện tại">
      <input type="password" placeholder="Mật khẩu mới">
      <input type="password" placeholder="Nhập lại mật khẩu mới">
      <button>Đổi mật khẩu</button>
    </section>

    <!-- Lịch sử khóa học -->
    <section id="lichsu">
      <h2>Lịch sử khóa học đã đăng ký</h2>
      <table>
        <thead>
          <tr>
            <th>Tên khóa học</th>
            <th>Ngày đăng ký</th>
            <th>Trạng thái</th>
          </tr>
        </thead>
        <tbody id="history-body"></tbody>
      </table>
    </section>
  </main>

  <footer>
    &copy; 2025 EduLearn. All rights reserved.
  </footer>

  <div class="modal" id="modal">
    <div class="modal-content">
      <h3 id="modal-title">Đăng ký khóa học</h3>
      <input type="text" id="discount-code" placeholder="Nhập mã giảm giá (nếu có)">
      <button onclick="confirmRegistration()">Xác nhận đăng ký</button>
      <button onclick="closeModal()" style="margin-top: 1rem; background: #ccc; color: #000;">Hủy</button>
    </div>
  </div>

  <script>
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const registrations = JSON.parse(localStorage.getItem('registrations')) || [];

    function renderCourses() {
      const approvedCourses = courses.filter(c => c.status === 'approved');
      const courseList = document.getElementById('course-list');
      courseList.innerHTML = '';
      approvedCourses.forEach(c => {
        courseList.innerHTML += `
          <tr>
            <td>${c.title}</td>
            <td>${c.description}</td>
            <td>${c.price}</td>
            <td><button onclick="openModal('${c.id}', '${c.title}')">Đăng ký</button></td>
          </tr>`;
      });
    }

    let selectedCourseId = '';
    let selectedCourseName = '';
    function openModal(courseId, courseName) {
      selectedCourseId = courseId;
      selectedCourseName = courseName;
      document.getElementById('modal-title').innerText = 'Đăng ký: ' + courseName;
      document.getElementById('modal').style.display = 'flex';
    }
    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }
    function confirmRegistration() {
      const code = document.getElementById('discount-code').value;
      const date = new Date().toLocaleDateString();
      registrations.push({ user: currentUser.username, courseId: selectedCourseId, date, status: 'Đang học', discount: code });
      localStorage.setItem('registrations', JSON.stringify(registrations));
      alert(`Đăng ký khóa học "${selectedCourseName}" thành công!\nMã giảm giá: ${code || 'Không có'}`);
      closeModal();
      renderHistory();
    }

    function renderHistory() {
      const history = registrations.filter(r => r.user === currentUser.username);
      const courseMap = Object.fromEntries(courses.map(c => [c.id, c.title]));
      const tbody = document.getElementById('history-body');
      tbody.innerHTML = '';
      history.forEach(r => {
        tbody.innerHTML += `<tr>
          <td>${courseMap[r.courseId] || 'Không xác định'}</td>
          <td>${r.date}</td>
          <td>${r.status}</td>
        </tr>`;
      });
    }

    renderCourses();
    renderHistory();
  </script>
</body>
</html>
